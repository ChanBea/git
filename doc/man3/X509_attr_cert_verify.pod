=pod

=head1 NAME

X509_attr_cert_verify, X509_attr_cert_verify_ex, acert_crl
- attribute certificate verification functions

=head1 SYNOPSIS

 int X509_attr_cert_verify(X509_ACERT *acert, X509 *issuer);
 int X509_attr_cert_verify_ex(X509_ACERT *acert, X509 *issuer, X509 *holder,
                              TARGET *tgt, int asserted_before);
 int acert_crl(X509_STORE_CTX *ctx, X509_CRL *crl, X509_ACERT *x);

=head1 DESCRIPTION

X509_attr_cert_verify verifies that the attribute ceritifcate B<acert> is signed
by the issuer B<issuer> and that the attribute certificate is valid with
respect to its validity times and its extensions. This function does B<not>
verify the B<issuer> certificate.

X509_attr_cert_verify_ex is the extended form of X509_attr_cert_verify, which
takes an optional B<holder> argument, B<tgt> argument, and B<asserted_before>
argument.

If not B<NULL>, the subject and subject alternative names are extracted from
the B<holder> public key certificate and compared against the holder field of
the asserted attribute certificate, B<acert>.

If not B<NULL>, the target is checked against the list of permitted targets
within the targetingInformation X.509v3 extension, if the extension is present.

If set to a truthy value, B<asserted_before> causes attribute certificate
verification to fail if the singleUse X.509v3 extension is present.

acert_crl returns 1 if the attribute certificate B<x> is not revoked in the
certificate revocation list B<crl>, some other integer otherwise.

=head1 NOTES

These functions verify an X.509 attribute certificate to varying degrees. None
of them verify the corresponding public key certificate, but the public key
certificates can just be verified using the normal OpenSSL verification
functions.

=head1 RETURN VALUES

Both X509_attr_cert_verify and X509_attr_cert_verify_ex return X509_V_OK (0) if
the attribute certificate is valid with respect to the supplied verification
parameters, or some other X509_V_ERR_ value otherwise. As stated above,
acert_crl returns 1 if the attribute certificate is not revoked in the provided
certificate revocation list, and some other integer otherwise.

=head1 COPYRIGHT

Copyright 2023 The OpenSSL Project Authors. All Rights Reserved.

Licensed under the Apache License 2.0 (the "License").  You may not use
this file except in compliance with the License.  You can obtain a copy
in the file LICENSE in the source distribution or at
L<https://www.openssl.org/source/license.html>.

=cut
