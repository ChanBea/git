title Option 3 OSSL_select() extended

autoactivation on
activate Application
loop until finished
Application->OpenSSL:OSSL_select()
OpenSSL->OpenSSL:t = get_next_timeout()
space
deactivate OpenSSL
OpenSSL->Libc:select(...,t)
OpenSSL<--Libc:fds
OpenSSL->OpenSSL:process_packets(fds)
OpenSSL->Libc:readmsg()
space
deactivate Libc
OpenSSL->OSSL_Stream:queue data
space
deactivate OSSL_Stream
OpenSSL->*OSSL_Connection:<<create>>
space
deactivate OpenSSL
deactivate OSSL_Connection
space
Application<--OpenSSL:events[]
Application->Application:handle_events(events)
Application->OSSL_Stream:read()
space
deactivate OSSL_Stream
deactivate Application
end
